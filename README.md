# 图像分割与颗粒分析应用

这是一个用于微观图像分割和颗粒分析的GUI应用程序。它可以帮助用户加载图像，执行图像分割，并分析颗粒的数量、面积和占比等统计信息。

## 功能特点

- 支持多种图像格式的加载（PNG、JPG、JPEG、BMP、TIFF）
- 提供三种阈值分割方法：
  - 手动阈值
  - Otsu自动阈值
  - 自适应阈值
- 支持形态学操作（开运算、闭运算、腐蚀+膨胀）
- 颗粒大小过滤
- 实时显示原始图像和分割结果
- 详细的颗粒统计信息：
  - 颗粒数量
  - 颗粒总面积
  - 颗粒占比百分比
- 可视化分析图表：
  - 颗粒面积分布直方图
  - 累积面积分布图
- 结果保存功能（图像和统计信息）

## 安装依赖

在运行应用程序之前，请安装所需的依赖包：

```bash
pip install -r requirements.txt
```

依赖包包括：
- opencv-python：图像处理
- numpy：数值计算
- pillow：图像处理
- matplotlib：数据可视化
- PyQt5：GUI界面
- scikit-image：高级图像处理功能

## 使用方法

1. 运行应用程序：

```bash
python image_segmentation_app.py
```

2. 点击"加载图像"按钮选择要分析的图像

3. 在左侧控制面板中调整分割参数：
   - 选择合适的阈值方法
   - 根据需要调整阈值、块大小、常数C等参数
   - 设置是否应用形态学操作及相关参数
   - 设置最小颗粒面积阈值

4. 点击"执行分割"按钮进行处理

5. 在右侧查看原始图像和分割结果

6. 在"结果分析"选项卡中查看统计数据和图表

7. 点击"保存结果"按钮保存分割后的图像和统计信息

## 参数说明

### 阈值方法
- **手动阈值**：用户可通过滑块或输入框直接设置阈值（0-255）
- **Otsu阈值**：自动计算最佳阈值
- **自适应阈值**：根据局部区域特性计算阈值，适用于光照不均匀的图像
  - **块大小**：计算阈值的局部区域大小，必须为奇数
  - **常数C**：从均值或高斯加权均值中减去的常数

### 形态学操作
- **开运算**：先腐蚀后膨胀，用于去除小的噪声点
- **闭运算**：先膨胀后腐蚀，用于填充小的空洞
- **腐蚀+膨胀**：先腐蚀后膨胀，可用于平滑边界
- **核大小**：形态学操作的结构元素大小

### 颗粒过滤
- **最小面积**：过滤掉小于指定面积的区域，单位为像素

## 注意事项

- 对于光照不均匀的图像，建议使用自适应阈值方法
- 对于有噪声的图像，建议使用形态学操作进行预处理
- 调整最小面积阈值可以过滤掉不需要的小颗粒或背景噪声
- 处理大图像时可能需要一定时间，请耐心等待

## 系统要求

- Python 3.6+
- 支持Windows、macOS和Linux操作系统
- 建议有足够的内存处理大型图像

## 示例

应用程序会将分割后的图像保存为彩色标记的形式，每个不同的颗粒会被标记为不同的颜色。同时会生成一个包含统计信息的文本文件。

## 许可证

本项目为开源软件，仅供学习和研究使用。